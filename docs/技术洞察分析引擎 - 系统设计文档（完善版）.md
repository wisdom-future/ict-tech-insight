**æŠ€æœ¯æ´å¯Ÿåˆ†æå¼•æ“ - ç³»ç»Ÿè®¾è®¡æ–‡æ¡£ï¼ˆå®Œå–„ç‰ˆï¼‰**

---

**å…¨ç³»ç»Ÿæ•°å­—ç‚¹å‡»å±•å¼€è¯¦æƒ…è®¾è®¡**

**é€šç”¨æ•°å­—å±•å¼€äº¤äº’è§„èŒƒï¼š**

**è®¾è®¡åŸåˆ™ï¼š**
- æ‰€æœ‰é¡µé¢çš„æ•°å­—å‹æŒ‡æ ‡éƒ½æ”¯æŒç‚¹å‡»å±•å¼€
- ç»Ÿä¸€çš„äº¤äº’æ ·å¼å’Œè¡Œä¸ºæ¨¡å¼
- æ ¹æ®æ•°æ®é‡è‡ªåŠ¨é€‰æ‹©å±•ç¤ºæ–¹å¼
- æ”¯æŒå¤šçº§æ•°æ®é’»å–

**é€šç”¨CSSæ ·å¼è§„èŒƒï¼š**
```css
/* å¯ç‚¹å‡»æ•°å­—çš„é€šç”¨æ ·å¼ */
.clickable-number {
  cursor: pointer;
  transition: all 0.3s ease;
  border-radius: 4px;
  padding: 2px 4px;
}

.clickable-number:hover {
  background-color: #f0f8ff;
  transform: scale(1.05);
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.clickable-number::after {
  content: " ğŸ”";
  font-size: 0.8em;
  opacity: 0;
  transition: opacity 0.3s ease;
}

.clickable-number:hover::after {
  opacity: 1;
}

/* ä¸åŒæ•°æ®é‡çº§çš„è§†è§‰æç¤º */
.clickable-number.small-data::after { content: " ğŸ“‹"; }
.clickable-number.medium-data::after { content: " ğŸ“Š"; }
.clickable-number.large-data::after { content: " ğŸ”—"; }
```

**é€šç”¨JavaScriptå±•å¼€é€»è¾‘ï¼š**
```javascript
// é€šç”¨æ•°å­—ç‚¹å‡»å¤„ç†å‡½æ•°
function handleNumberClick(element, dataType, value, metadata = {}) {
  const dataCount = metadata.count || value;
  const pageContext = metadata.page || getCurrentPage();
  
  // æ ¹æ®æ•°æ®é‡å†³å®šå±•ç¤ºæ–¹å¼
  if (dataCount <= 50) {
    showModalDetails(dataType, value, metadata);
  } else if (dataCount <= 500) {
    showExpandedModal(dataType, value, metadata);
  } else {
    openDetailPage(dataType, value, metadata);
  }
  
  // è®°å½•ç”¨æˆ·è¡Œä¸º
  logUserInteraction('number_click', {
    page: pageContext,
    dataType: dataType,
    value: value,
    timestamp: new Date().toISOString()
  });
}

// æ¨¡æ€æ¡†è¯¦æƒ…å±•ç¤º
function showModalDetails(dataType, value, metadata) {
  const modal = document.getElementById('universalDetailModal');
  const modalTitle = document.getElementById('modalTitle');
  const modalContent = document.getElementById('modalContent');
  
  modalTitle.textContent = generateModalTitle(dataType, value, metadata);
  modalContent.innerHTML = '<div class="loading-spinner">åŠ è½½ä¸­...</div>';
  
  modal.style.display = 'block';
  
  // å¼‚æ­¥åŠ è½½è¯¦ç»†æ•°æ®
  google.script.run
    .withSuccessHandler(data => renderModalContent(modalContent, data))
    .withFailureHandler(error => showErrorInModal(modalContent, error))
    .getDetailedData(dataType, metadata);
}

// æ–°é¡µé¢è¯¦æƒ…å±•ç¤º
function openDetailPage(dataType, value, metadata) {
  const params = new URLSearchParams({
    type: dataType,
    value: value,
    ...metadata
  });
  
  const detailUrl = `details.html?${params.toString()}`;
  window.open(detailUrl, '_blank', 'width=1200,height=800,scrollbars=yes');
}
```

---

**å„é¡µé¢æ•°å­—å±•å¼€åŠŸèƒ½è¯¦ç»†è®¾è®¡**

**1. ä¸»é¡µé¢ï¼ˆindex.htmlï¼‰æ•°å­—å±•å¼€ï¼š**

```html
<!-- ä¸»é¡µKPIæ•°å­—å±•å¼€ç¤ºä¾‹ -->
<div class="kpi-card">
  <div class="kpi-number clickable-number medium-data" 
       onclick="handleNumberClick(this, 'daily_insights', 42, {
         page: 'overview',
         dateRange: 'today',
         category: 'all'
       })">
    42
  </div>
  <div class="kpi-label">ä»Šæ—¥æ–°å¢æ´å¯Ÿ</div>
</div>

<div class="kpi-card">
  <div class="kpi-number clickable-number small-data"
       onclick="handleNumberClick(this, 'processing_tasks', 8, {
         page: 'overview',
         status: 'processing'
       })">
    8
  </div>
  <div class="kpi-label">å¤„ç†ä¸­ä»»åŠ¡</div>
</div>

<div class="kpi-card">
  <div class="kpi-number clickable-number small-data"
       onclick="handleNumberClick(this, 'system_health', 98.2, {
         page: 'overview',
         metric: 'health_score'
       })">
    98.2%
  </div>
  <div class="kpi-label">ç³»ç»Ÿå¥åº·åº¦</div>
</div>
```

**2. æ•°æ®é‡‡é›†é¡µé¢ï¼ˆcollection.htmlï¼‰æ•°å­—å±•å¼€ï¼š**

```html
<!-- æŠ€æœ¯æ•°æ®é‡‡é›†åŒºåŸŸæ•°å­—å±•å¼€ -->
<div class="tech-data-section">
  <div class="data-source-card">
    <div class="card-metrics">
      <div class="metric-item">
        <div class="metric-number clickable-number medium-data"
             onclick="handleNumberClick(this, 'academic_papers_today', 45, {
               page: 'collection',
               source: 'academic_papers',
               dateRange: 'today',
               detailLevel: 'full'
             })">
          45
        </div>
        <div class="metric-label">ä»Šæ—¥é‡‡é›†</div>
      </div>
      
      <div class="metric-item">
        <div class="metric-number clickable-number large-data"
             onclick="handleNumberClick(this, 'academic_papers_total', 1250, {
               page: 'collection',
               source: 'academic_papers',
               dateRange: 'all',
               enablePagination: true,
               pageSize: 25
             })">
          1,250
        </div>
        <div class="metric-label">æ€»è®¡</div>
      </div>
      
      <div class="metric-item">
        <div class="metric-number clickable-number small-data"
             onclick="handleNumberClick(this, 'papers_quality_breakdown', 8.2, {
               page: 'collection',
               source: 'academic_papers',
               metric: 'quality_distribution'
             })">
          8.2
        </div>
        <div class="metric-label">è´¨é‡è¯„åˆ†</div>
      </div>
    </div>
  </div>
</div>

<!-- æ ‡æ†æ•°æ®é‡‡é›†åŒºåŸŸæ•°å­—å±•å¼€ -->
<div class="benchmark-data-section">
  <div class="data-source-card">
    <div class="card-metrics">
      <div class="metric-item">
        <div class="metric-number clickable-number medium-data"
             onclick="handleNumberClick(this, 'industry_dynamics_today', 32, {
               page: 'collection',
               source: 'industry_dynamics',
               dateRange: 'today',
               includeDetails: true
             })">
          32
        </div>
        <div class="metric-label">ä»Šæ—¥åŠ¨æ€</div>
      </div>
      
      <div class="metric-item">
        <div class="metric-number clickable-number small-data"
             onclick="handleNumberClick(this, 'critical_events', 5, {
               page: 'collection',
               source: 'industry_dynamics',
               priority: 'critical',
               showTimeline: true
             })">
          5
        </div>
        <div class="metric-label">é‡è¦äº‹ä»¶</div>
      </div>
    </div>
  </div>
</div>
```

**3. æŠ€æœ¯æ´å¯Ÿé¡µé¢ï¼ˆinsights.htmlï¼‰æ•°å­—å±•å¼€ï¼š**

```html
<!-- æ´å¯Ÿæ¦‚è§ˆæ•°å­—å±•å¼€ -->
<div class="insights-overview">
  <div class="metric-card">
    <div class="metric-number clickable-number large-data"
         onclick="handleNumberClick(this, 'total_insights', 128, {
           page: 'insights',
           category: 'all',
           sortBy: 'date_desc',
           enableFiltering: true
         })">
      128
    </div>
    <div class="metric-label">æ€»æ´å¯Ÿæ•°</div>
  </div>
  
  <div class="metric-card">
    <div class="metric-number clickable-number medium-data"
         onclick="handleNumberClick(this, 'high_value_insights', 23, {
           page: 'insights',
           valueThreshold: 8.0,
           includeAnalysis: true,
           showActionable: true
         })">
      23
    </div>
    <div class="metric-label">é«˜ä»·å€¼æ´å¯Ÿ</div>
  </div>
</div>

<!-- å•†ä¸šä»·å€¼åˆ†ææ•°å­—å±•å¼€ -->
<div id="commercial-panel" class="analysis-panel">
  <div class="roi-metrics">
    <div class="roi-item">
      <div class="roi-number clickable-number small-data"
           onclick="handleNumberClick(this, 'high_roi_projects', 8, {
             page: 'insights',
             analysis: 'commercial',
             roiThreshold: 20,
             showProjectDetails: true
           })">
        8
      </div>
      <div class="roi-label">é«˜ROIé¡¹ç›®</div>
    </div>
    
    <div class="roi-item">
      <div class="roi-number clickable-number small-data"
           onclick="handleNumberClick(this, 'average_roi_breakdown', 15.6, {
             page: 'insights',
             analysis: 'commercial',
             metric: 'roi_distribution',
             showCalculation: true
           })">
        15.6%
      </div>
      <div class="roi-label">å¹³å‡ROI</div>
    </div>
  </div>
</div>

<!-- ç«äº‰æƒ…æŠ¥åˆ†ææ•°å­—å±•å¼€ -->
<div id="competitive-panel" class="analysis-panel">
  <div class="threat-assessment">
    <div class="threat-level-card high">
      <div class="threat-number clickable-number small-data"
           onclick="handleNumberClick(this, 'high_threat_competitors', 3, {
             page: 'insights',
             analysis: 'competitive',
             threatLevel: 'high',
             showCompetitorProfiles: true
           })">
        3
      </div>
      <div class="threat-label">é«˜å¨èƒ</div>
    </div>
  </div>
</div>
```

**4. å†³ç­–è¡ŒåŠ¨é¡µé¢ï¼ˆactions.htmlï¼‰æ•°å­—å±•å¼€ï¼š**

```html
<!-- å†³ç­–ä»ªè¡¨æ¿æ•°å­—å±•å¼€ -->
<div class="decision-dashboard">
  <div class="metric-card investment">
    <div class="metric-number clickable-number medium-data"
         onclick="handleNumberClick(this, 'investment_opportunities', 25, {
           page: 'actions',
           category: 'opportunities',
           enableGrading: true,
           showROIProjection: true
         })">
      25
    </div>
    <div class="metric-label">æŠ•èµ„æœºä¼š</div>
  </div>
  
  <div class="metric-card actions">
    <div class="metric-number clickable-number medium-data"
         onclick="handleNumberClick(this, 'pending_actions', 12, {
           page: 'actions',
           status: 'pending',
           enableStatusUpdate: true,
           showPriorityFilter: true
         })">
      12
    </div>
    <div class="metric-label">å¾…æ‰§è¡Œè¡ŒåŠ¨</div>
  </div>
</div>

<!-- æŠ•èµ„æœºä¼šè¯„çº§æ•°å­—å±•å¼€ -->
<div class="investment-opportunities">
  <div class="level-card grade-a">
    <div class="grade-number clickable-number small-data"
         onclick="handleNumberClick(this, 'grade_a_opportunities', 5, {
           page: 'actions',
           grade: 'A',
           showDetailedAnalysis: true,
           enableActionInput: true
         })">
      5
    </div>
    <div class="grade-label">é«˜ä»·å€¼æœºä¼š</div>
  </div>
</div>
```

**5. æŠ¥å‘Šé¡µé¢ï¼ˆreports.htmlï¼‰æ•°å­—å±•å¼€ï¼š**

```html
<!-- æŠ¥å‘Šç»Ÿè®¡æ•°å­—å±•å¼€ -->
<div class="reports-stats">
  <div class="stat-card">
    <div class="stat-number clickable-number medium-data"
         onclick="handleNumberClick(this, 'daily_reports', 30, {
           page: 'reports',
           reportType: 'daily',
           dateRange: 'last_30_days',
           enableSearch: true
         })">
      30
    </div>
    <div class="stat-label">æ—¥æŠ¥</div>
  </div>
  
  <div class="stat-card">
    <div class="stat-number clickable-number small-data"
         onclick="handleNumberClick(this, 'weekly_reports', 4, {
           page: 'reports',
           reportType: 'weekly',
           showContent: true,
           enableDownload: true
         })">
      4
    </div>
    <div class="stat-label">å‘¨æŠ¥</div>
  </div>
</div>
```

---

**é«˜ä»·å€¼çº¿ç´¢è¡ŒåŠ¨è¾“å…¥åŠŸèƒ½è®¾è®¡**

**é«˜ä»·å€¼çº¿ç´¢è¡ŒåŠ¨ç®¡ç†ç•Œé¢ï¼š**

```html
<!-- é«˜ä»·å€¼çº¿ç´¢è¯¦æƒ…å¼¹çª— -->
<div id="highValueInsightModal" class="modal large-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3 id="insightTitle">é«˜ä»·å€¼çº¿ç´¢è¯¦æƒ…</h3>
      <span class="close">&times;</span>
    </div>
    
    <div class="modal-body">
      <!-- çº¿ç´¢åŸºæœ¬ä¿¡æ¯ -->
      <div class="insight-basic-info">
        <div class="info-grid">
          <div class="info-item">
            <label>çº¿ç´¢ID:</label>
            <span id="insightId">TI20250624001</span>
          </div>
          <div class="info-item">
            <label>å‘ç°æ—¶é—´:</label>
            <span id="discoveryTime">2025-06-24 09:30:00</span>
          </div>
          <div class="info-item">
            <label>ä»·å€¼è¯„åˆ†:</label>
            <span id="valueScore" class="score-high">9.2/10</span>
          </div>
          <div class="info-item">
            <label>å½“å‰çŠ¶æ€:</label>
            <span id="currentStatus" class="status-pending">å¾…è¡ŒåŠ¨</span>
          </div>
        </div>
      </div>
      
      <!-- çº¿ç´¢è¯¦ç»†å†…å®¹ -->
      <div class="insight-content">
        <h4>çº¿ç´¢å†…å®¹</h4>
        <div id="insightContent" class="content-display">
          <!-- åŠ¨æ€åŠ è½½çº¿ç´¢è¯¦ç»†å†…å®¹ -->
        </div>
      </div>
      
      <!-- åˆ†æç»“æœ -->
      <div class="analysis-results">
        <div class="analysis-tabs">
          <div class="tab active" data-tab="commercial">å•†ä¸šåˆ†æ</div>
          <div class="tab" data-tab="technical">æŠ€æœ¯åˆ†æ</div>
          <div class="tab" data-tab="competitive">ç«äº‰åˆ†æ</div>
        </div>
        <div class="analysis-content" id="analysisContent">
          <!-- åŠ¨æ€åŠ è½½åˆ†æå†…å®¹ -->
        </div>
      </div>
      
      <!-- å†å²è¡ŒåŠ¨è®°å½• -->
      <div class="action-history">
        <h4>å†å²è¡ŒåŠ¨è®°å½•</h4>
        <div id="actionHistory" class="history-timeline">
          <!-- åŠ¨æ€åŠ è½½å†å²è®°å½• -->
        </div>
      </div>
      
      <!-- ä¸‹ä¸€æ­¥è¡ŒåŠ¨è¾“å…¥åŒºåŸŸ -->
      <div class="next-action-section">
        <h4>ä¸‹ä¸€æ­¥è¡ŒåŠ¨è§„åˆ’</h4>
        
        <form id="nextActionForm" class="action-form">
          <div class="form-group">
            <label for="actionType">è¡ŒåŠ¨ç±»å‹:</label>
            <select id="actionType" name="actionType" required>
              <option value="">è¯·é€‰æ‹©è¡ŒåŠ¨ç±»å‹</option>
              <option value="investment">æŠ•èµ„å†³ç­–</option>
              <option value="research">æ·±å…¥ç ”ç©¶</option>
              <option value="partnership">å¯»æ±‚åˆä½œ</option>
              <option value="monitoring">æŒç»­ç›‘æ§</option>
              <option value="prototype">åŸå‹å¼€å‘</option>
              <option value="market_analysis">å¸‚åœºåˆ†æ</option>
              <option value="competitive_response">ç«äº‰åº”å¯¹</option>
              <option value="other">å…¶ä»–</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="actionPriority">ä¼˜å…ˆçº§:</label>
            <select id="actionPriority" name="actionPriority" required>
              <option value="">è¯·é€‰æ‹©ä¼˜å…ˆçº§</option>
              <option value="urgent">ç´§æ€¥</option>
              <option value="high">é«˜</option>
              <option value="medium">ä¸­</option>
              <option value="low">ä½</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="actionDescription">è¡ŒåŠ¨æè¿°:</label>
            <textarea id="actionDescription" name="actionDescription" 
                      rows="4" placeholder="è¯·è¯¦ç»†æè¿°ä¸‹ä¸€æ­¥å…·ä½“è¡ŒåŠ¨è®¡åˆ’..." required></textarea>
          </div>
          
          <div class="form-group">
            <label for="expectedOutcome">é¢„æœŸç»“æœ:</label>
            <textarea id="expectedOutcome" name="expectedOutcome" 
                      rows="3" placeholder="æè¿°é¢„æœŸè¾¾æˆçš„ç»“æœå’Œç›®æ ‡..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="estimatedBudget">é¢„ä¼°é¢„ç®—:</label>
            <div class="budget-input">
              <select id="budgetCurrency" name="budgetCurrency">
                <option value="USD">USD</option>
                <option value="CNY">CNY</option>
                <option value="EUR">EUR</option>
              </select>
              <input type="number" id="estimatedBudget" name="estimatedBudget" 
                     placeholder="0" min="0" step="1000">
            </div>
          </div>
          
          <div class="form-group">
            <label for="targetDate">ç›®æ ‡å®Œæˆæ—¥æœŸ:</label>
            <input type="date" id="targetDate" name="targetDate" required>
          </div>
          
          <div class="form-group">
            <label for="assignedTo">è´Ÿè´£äºº:</label>
            <input type="text" id="assignedTo" name="assignedTo" 
                   placeholder="è¾“å…¥è´Ÿè´£äººå§“åæˆ–é‚®ç®±">
          </div>
          
          <div class="form-group">
            <label for="keyMilestones">å…³é”®é‡Œç¨‹ç¢‘:</label>
            <div id="milestonesContainer">
              <div class="milestone-item">
                <input type="text" name="milestone[]" placeholder="é‡Œç¨‹ç¢‘æè¿°">
                <input type="date" name="milestoneDate[]">
                <button type="button" onclick="removeMilestone(this)">åˆ é™¤</button>
              </div>
            </div>
            <button type="button" onclick="addMilestone()">æ·»åŠ é‡Œç¨‹ç¢‘</button>
          </div>
          
          <div class="form-group">
            <label for="riskAssessment">é£é™©è¯„ä¼°:</label>
            <textarea id="riskAssessment" name="riskAssessment" 
                      rows="3" placeholder="è¯†åˆ«å¯èƒ½çš„é£é™©å’Œåº”å¯¹æªæ–½..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="successMetrics">æˆåŠŸæŒ‡æ ‡:</label>
            <textarea id="successMetrics" name="successMetrics" 
                      rows="2" placeholder="å®šä¹‰è¡¡é‡æˆåŠŸçš„å…·ä½“æŒ‡æ ‡..."></textarea>
          </div>
          
          <div class="form-actions">
            <button type="button" onclick="saveAsDraft()">ä¿å­˜è‰ç¨¿</button>
            <button type="submit">æäº¤è¡ŒåŠ¨è®¡åˆ’</button>
            <button type="button" onclick="closeModal()">å–æ¶ˆ</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
```

**è¡ŒåŠ¨è¾“å…¥çš„JavaScriptå¤„ç†é€»è¾‘ï¼š**

```javascript
// é«˜ä»·å€¼çº¿ç´¢è¡ŒåŠ¨ç®¡ç†ç±»
class HighValueInsightActionManager {
  
  constructor() {
    this.currentInsightId = null;
    this.formValidator = new FormValidator();
  }
  
  // æ˜¾ç¤ºé«˜ä»·å€¼çº¿ç´¢è¯¦æƒ…å’Œè¡ŒåŠ¨è¾“å…¥ç•Œé¢
  showInsightActionModal(insightId) {
    this.currentInsightId = insightId;
    
    // åŠ è½½çº¿ç´¢è¯¦æƒ…
    google.script.run
      .withSuccessHandler(data => this.renderInsightDetails(data))
      .withFailureHandler(error => this.handleError(error))
      .getHighValueInsightDetails(insightId);
    
    // æ˜¾ç¤ºæ¨¡æ€æ¡†
    document.getElementById('highValueInsightModal').style.display = 'block';
  }
  
  // æ¸²æŸ“çº¿ç´¢è¯¦æƒ…
  renderInsightDetails(data) {
    document.getElementById('insightId').textContent = data.insightId;
    document.getElementById('discoveryTime').textContent = data.discoveryTime;
    document.getElementById('valueScore').textContent = `${data.valueScore}/10`;
    document.getElementById('currentStatus').textContent = data.currentStatus;
    document.getElementById('insightContent').innerHTML = data.content;
    
    // æ¸²æŸ“åˆ†æç»“æœ
    this.renderAnalysisResults(data.analysisResults);
    
    // æ¸²æŸ“å†å²è¡ŒåŠ¨è®°å½•
    this.renderActionHistory(data.actionHistory);
    
    // é¢„å¡«å……è¡¨å•ï¼ˆå¦‚æœæœ‰è‰ç¨¿ï¼‰
    if (data.draftAction) {
      this.populateForm(data.draftAction);
    }
  }
  
  // æäº¤è¡ŒåŠ¨è®¡åˆ’
  submitActionPlan(formData) {
    // è¡¨å•éªŒè¯
    if (!this.formValidator.validate(formData)) {
      return;
    }
    
    // æ˜¾ç¤ºæäº¤çŠ¶æ€
    this.showSubmitStatus('submitting');
    
    // å‡†å¤‡æäº¤æ•°æ®
    const actionData = {
      insightId: this.currentInsightId,
      actionType: formData.actionType,
      priority: formData.actionPriority,
      description: formData.actionDescription,
      expectedOutcome: formData.expectedOutcome,
      estimatedBudget: {
        amount: formData.estimatedBudget,
        currency: formData.budgetCurrency
      },
      targetDate: formData.targetDate,
      assignedTo: formData.assignedTo,
      milestones: this.parseMilestones(formData),
      riskAssessment: formData.riskAssessment,
      successMetrics: formData.successMetrics,
      createdBy: Session.getActiveUser().getEmail(),
      createdAt: new Date().toISOString(),
      status: 'planned'
    };
    
    // æäº¤åˆ°åç«¯
    google.script.run
      .withSuccessHandler(result => this.handleSubmitSuccess(result))
      .withFailureHandler(error => this.handleSubmitError(error))
      .saveHighValueInsightAction(actionData);
  }
  
  // ä¿å­˜è‰ç¨¿
  saveAsDraft() {
    const formData = this.getFormData();
    const draftData = {
      insightId: this.currentInsightId,
      formData: formData,
      savedAt: new Date().toISOString()
    };
    
    google.script.run
      .withSuccessHandler(() => this.showMessage('è‰ç¨¿å·²ä¿å­˜', 'success'))
      .withFailureHandler(error => this.showMessage('ä¿å­˜è‰ç¨¿å¤±è´¥', 'error'))
      .saveDraftAction(draftData);
  }
  
  // æ·»åŠ é‡Œç¨‹ç¢‘
  addMilestone() {
    const container = document.getElementById('milestonesContainer');
    const milestoneItem = document.createElement('div');
    milestoneItem.className = 'milestone-item';
    milestoneItem.innerHTML = `
      <input type="text" name="milestone[]" placeholder="é‡Œç¨‹ç¢‘æè¿°">
      <input type="date" name="milestoneDate[]">
      <button type="button" onclick="removeMilestone(this)">åˆ é™¤</button>
    `;
    container.appendChild(milestoneItem);
  }
  
  // åˆ é™¤é‡Œç¨‹ç¢‘
  removeMilestone(button) {
    button.parentElement.remove();
  }
  
  // è·å–è¡¨å•æ•°æ®
  getFormData() {
    const form = document.getElementById('nextActionForm');
    const formData = new FormData(form);
    const data = {};
    
    for (let [key, value] of formData.entries()) {
      if (key.endsWith('[]')) {
        const arrayKey = key.slice(0, -2);
        if (!data[arrayKey]) data[arrayKey] = [];
        data[arrayKey].push(value);
      } else {
        data[key] = value;
      }
    }
    
    return data;
  }
  
  // å¤„ç†æäº¤æˆåŠŸ
  handleSubmitSuccess(result) {
    this.showSubmitStatus('success');
    this.showMessage('è¡ŒåŠ¨è®¡åˆ’æäº¤æˆåŠŸï¼', 'success');
    
    // æ›´æ–°çº¿ç´¢çŠ¶æ€
    this.updateInsightStatus(result.insightId, 'action_planned');
    
    // æ¸…ç©ºè¡¨å•
    document.getElementById('nextActionForm').reset();
    
    // åˆ·æ–°ç›¸å…³æ•°æ®
    this.refreshActionData();
    
    // 3ç§’åå…³é—­æ¨¡æ€æ¡†
    setTimeout(() => {
      this.closeModal();
    }, 3000);
  }
  
  // å¤„ç†æäº¤é”™è¯¯
  handleSubmitError(error) {
    this.showSubmitStatus('error');
    this.showMessage(`æäº¤å¤±è´¥: ${error.message}`, 'error');
  }
}

// è¡¨å•éªŒè¯å™¨
class FormValidator {
  validate(formData) {
    const errors = [];
    
    // å¿…å¡«å­—æ®µéªŒè¯
    if (!formData.actionType) errors.push('è¯·é€‰æ‹©è¡ŒåŠ¨ç±»å‹');
    if (!formData.actionPriority) errors.push('è¯·é€‰æ‹©ä¼˜å…ˆçº§');
    if (!formData.actionDescription) errors.push('è¯·å¡«å†™è¡ŒåŠ¨æè¿°');
    if (!formData.targetDate) errors.push('è¯·é€‰æ‹©ç›®æ ‡å®Œæˆæ—¥æœŸ');
    
    // æ—¥æœŸéªŒè¯
    if (formData.targetDate && new Date(formData.targetDate) <= new Date()) {
      errors.push('ç›®æ ‡å®Œæˆæ—¥æœŸå¿…é¡»æ˜¯æœªæ¥æ—¥æœŸ');
    }
    
    // é¢„ç®—éªŒè¯
    if (formData.estimatedBudget && formData.estimatedBudget < 0) {
      errors.push('é¢„ä¼°é¢„ç®—ä¸èƒ½ä¸ºè´Ÿæ•°');
    }
    
    // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    if (errors.length > 0) {
      this.showValidationErrors(errors);
      return false;
    }
    
    return true;
  }
  
  showValidationErrors(errors) {
    const errorContainer = document.createElement('div');
    errorContainer.className = 'validation-errors';
    errorContainer.innerHTML = `
      <h4>è¯·ä¿®æ­£ä»¥ä¸‹é”™è¯¯ï¼š</h4>
      <ul>
        ${errors.map(error => `<li>${error}</li>`).join('')}
      </ul>
    `;
    
    // æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
    const form = document.getElementById('nextActionForm');
    form.insertBefore(errorContainer, form.firstChild);
    
    // 3ç§’åè‡ªåŠ¨éšè—
    setTimeout(() => {
      errorContainer.remove();
    }, 5000);
  }
}

// åˆå§‹åŒ–è¡ŒåŠ¨ç®¡ç†å™¨
const insightActionManager = new HighValueInsightActionManager();

// è¡¨å•æäº¤äº‹ä»¶å¤„ç†
document.getElementById('nextActionForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const formData = insightActionManager.getFormData();
  insightActionManager.submitActionPlan(formData);
});
```

**åç«¯æ•°æ®åº“å†™å…¥æœåŠ¡ï¼š**

```javascript
// Google Apps Script åç«¯æœåŠ¡
function saveHighValueInsightAction(actionData) {
  try {
    // è·å–è¡ŒåŠ¨å»ºè®®è¡¨
    const actionSheet = SpreadsheetApp.openById(ACTION_RECOMMENDATIONS_SHEET_ID)
                                    .getSheetByName('Action_Recommendations');
    
    // ç”Ÿæˆè¡ŒåŠ¨ID
    const actionId = generateActionId();
    
    // å‡†å¤‡å†™å…¥æ•°æ®
    const rowData = [
      actionId,                           // action_id
      actionData.insightId,              // related_insight_id
      actionData.actionType,             // action_type
      actionData.priority,               // priority
      actionData.description,            // description
      actionData.expectedOutcome,        // expected_outcome
      actionData.estimatedBudget.amount, // estimated_budget
      actionData.estimatedBudget.currency, // budget_currency
      actionData.targetDate,             // target_date
      actionData.assignedTo,             // assigned_to
      JSON.stringify(actionData.milestones), // milestones
      actionData.riskAssessment,         // risk_assessment
      actionData.successMetrics,         // success_metrics
      actionData.status,                 // status
      actionData.createdBy,              // created_by
      actionData.createdAt,              // created_at
      '',                                // updated_at
      '',                                // completed_at
      ''                                 // notes
    ];
    
    // å†™å…¥æ•°æ®
    actionSheet.appendRow(rowData);
    
    // æ›´æ–°ç›¸å…³æ´å¯Ÿçš„çŠ¶æ€
    updateInsightActionStatus(actionData.insightId, actionId, 'action_planned');
    
    // å‘é€é€šçŸ¥ï¼ˆå¦‚æœæŒ‡å®šäº†è´Ÿè´£äººï¼‰
    if (actionData.assignedTo) {
      sendActionAssignmentNotification(actionData);
    }
    
    return {
      success: true,
      actionId: actionId,
      insightId: actionData.insightId,
      message: 'è¡ŒåŠ¨è®¡åˆ’ä¿å­˜æˆåŠŸ'
    };
    
  } catch (error) {
    console.error('ä¿å­˜è¡ŒåŠ¨è®¡åˆ’å¤±è´¥:', error);
    throw new Error(`ä¿å­˜å¤±è´¥: ${error.message}`);
  }
}

// æ›´æ–°æ´å¯ŸçŠ¶æ€
function updateInsightActionStatus(insightId, actionId, status) {
  try {
    // è·å–æŠ€æœ¯æ´å¯Ÿä¸»è¡¨
    const masterSheet = SpreadsheetApp.openById(TECH_INTELLIGENCE_MASTER_SHEET_ID)
                                     .getSheetByName('Tech_Intelligence_Master');
    
    const data = masterSheet.getDataRange().getValues();
    const headers = data[0];
    const insightIdCol = headers.indexOf('intelligence_id');
    const actionStatusCol = headers.indexOf('action_status');
    const linkedActionCol = headers.indexOf('linked_action_id');
    const lastUpdateCol = headers.indexOf('last_update_timestamp');
    
    // æŸ¥æ‰¾å¯¹åº”çš„æ´å¯Ÿè®°å½•
    for (let i = 1; i < data.length; i++) {
      if (data[i][insightIdCol] === insightId) {
        // æ›´æ–°çŠ¶æ€
        masterSheet.getRange(i + 1, actionStatusCol + 1).setValue(status);
        masterSheet.getRange(i + 1, linkedActionCol + 1).setValue(actionId);
        masterSheet.getRange(i + 1, lastUpdateCol + 1).setValue(new Date().toISOString());
        break;
      }
    }
    
    return true;
  } catch (error) {
    console.error('æ›´æ–°æ´å¯ŸçŠ¶æ€å¤±è´¥:', error);
    throw error;
  }
}

// ç”Ÿæˆè¡ŒåŠ¨ID
function generateActionId() {
  const timestamp = new Date().toISOString().replace(/[-:T.]/g, '').substring(0, 14);
  const random = Math.random().toString(36).substring(2, 6).toUpperCase();
  return `ACT${timestamp}${random}`;
}

// ä¿å­˜è‰ç¨¿è¡ŒåŠ¨
function saveDraftAction(draftData) {
  try {
    // è·å–è‰ç¨¿å­˜å‚¨è¡¨ï¼ˆå¦‚æœä¸å­˜åœ¨åˆ™åˆ›å»ºï¼‰
    const draftSheet = getOrCreateDraftSheet();
    
    const rowData = [
      draftData.insightId,
      JSON.stringify(draftData.formData),
      draftData.savedAt,
      Session.getActiveUser().getEmail()
    ];
    
    // æ£€æŸ¥æ˜¯å¦å·²æœ‰è‰ç¨¿
    const existingDraftRow = findExistingDraft(draftSheet, draftData.insightId);
    
    if (existingDraftRow > 0) {
      // æ›´æ–°ç°æœ‰è‰ç¨¿
      draftSheet.getRange(existingDraftRow, 1, 1, rowData.length).setValues([rowData]);
    } else {
      // åˆ›å»ºæ–°è‰ç¨¿
      draftSheet.appendRow(rowData);
    }
    
    return { success: true, message: 'è‰ç¨¿ä¿å­˜æˆåŠŸ' };
  } catch (error) {
    console.error('ä¿å­˜è‰ç¨¿å¤±è´¥:', error);
    throw new Error(`ä¿å­˜è‰ç¨¿å¤±è´¥: ${error.message}`);
  }
}

// è·å–æˆ–åˆ›å»ºè‰ç¨¿è¡¨
function getOrCreateDraftSheet() {
  const spreadsheet = SpreadsheetApp.openById(ACTION_RECOMMENDATIONS_SHEET_ID);
  let draftSheet = spreadsheet.getSheetByName('Action_Drafts');
  
  if (!draftSheet) {
    draftSheet = spreadsheet.insertSheet('Action_Drafts');
    const headers = ['insight_id', 'draft_data', 'saved_at', 'saved_by'];
    draftSheet.getRange(1, 1, 1, headers.length).setValues([headers]);
  }
  
  return draftSheet;
}

// æŸ¥æ‰¾ç°æœ‰è‰ç¨¿
function findExistingDraft(draftSheet, insightId) {
  const data = draftSheet.getDataRange().getValues();
  for (let i = 1; i < data.length; i++) {
    if (data[i][0] === insightId) {
      return i + 1; // è¿”å›è¡Œå·ï¼ˆ1-basedï¼‰
    }
  }
  return 0; // æœªæ‰¾åˆ°
}

// å‘é€è¡ŒåŠ¨åˆ†é…é€šçŸ¥
function sendActionAssignmentNotification(actionData) {
  try {
    const emailSubject = `æ–°çš„è¡ŒåŠ¨è®¡åˆ’åˆ†é… - ${actionData.insightId}`;
    const emailBody = `
      æ‚¨å¥½ï¼Œ
      
      æ‚¨è¢«åˆ†é…äº†ä¸€ä¸ªæ–°çš„è¡ŒåŠ¨è®¡åˆ’ï¼š
      
      æ´å¯ŸID: ${actionData.insightId}
      è¡ŒåŠ¨ç±»å‹: ${actionData.actionType}
      ä¼˜å…ˆçº§: ${actionData.priority}
      ç›®æ ‡å®Œæˆæ—¥æœŸ: ${actionData.targetDate}
      
      è¡ŒåŠ¨æè¿°:
      ${actionData.description}
      
      é¢„æœŸç»“æœ:
      ${actionData.expectedOutcome}
      
      è¯·ç™»å½•ç³»ç»ŸæŸ¥çœ‹è¯¦ç»†ä¿¡æ¯å¹¶å¼€å§‹æ‰§è¡Œã€‚
      
      æŠ€æœ¯æ´å¯Ÿåˆ†æå¼•æ“
      ${new Date().toLocaleString()}
    `;
    
    // å‘é€é‚®ä»¶é€šçŸ¥
    GmailApp.sendEmail(actionData.assignedTo, emailSubject, emailBody);
    
    // è®°å½•é€šçŸ¥æ—¥å¿—
    logNotification('action_assignment', actionData.assignedTo, actionData.insightId);
    
  } catch (error) {
    console.error('å‘é€é€šçŸ¥å¤±è´¥:', error);
    // é€šçŸ¥å¤±è´¥ä¸åº”è¯¥å½±å“ä¸»æµç¨‹ï¼Œåªè®°å½•é”™è¯¯
  }
}
```

**è¡ŒåŠ¨è¿›åº¦è·Ÿè¸ªå’Œæ›´æ–°åŠŸèƒ½ï¼š**

```html
<!-- è¡ŒåŠ¨è¿›åº¦æ›´æ–°ç•Œé¢ -->
<div id="actionProgressModal" class="modal">
  <div class="modal-content">
    <div class="modal-header">
      <h3>è¡ŒåŠ¨è¿›åº¦æ›´æ–°</h3>
      <span class="close">&times;</span>
    </div>
    
    <div class="modal-body">
      <div class="action-summary">
        <h4 id="actionTitle">è¡ŒåŠ¨è®¡åˆ’æ¦‚è¦</h4>
        <div class="summary-grid">
          <div class="summary-item">
            <label>è¡ŒåŠ¨ID:</label>
            <span id="actionId"></span>
          </div>
          <div class="summary-item">
            <label>å…³è”æ´å¯Ÿ:</label>
            <span id="relatedInsight"></span>
          </div>
          <div class="summary-item">
            <label>å½“å‰çŠ¶æ€:</label>
            <span id="currentActionStatus"></span>
          </div>
          <div class="summary-item">
            <label>è¿›åº¦:</label>
            <div class="progress-bar">
              <div id="progressFill" class="progress-fill"></div>
              <span id="progressText">0%</span>
            </div>
          </div>
        </div>
      </div>
      
      <div class="progress-update-form">
        <h4>è¿›åº¦æ›´æ–°</h4>
        <form id="progressUpdateForm">
          <div class="form-group">
            <label for="progressPercentage">å®Œæˆè¿›åº¦ (%):</label>
            <input type="range" id="progressPercentage" name="progressPercentage" 
                   min="0" max="100" step="5" 
                   oninput="updateProgressDisplay(this.value)">
            <span id="progressValue">0%</span>
          </div>
          
          <div class="form-group">
            <label for="statusUpdate">çŠ¶æ€æ›´æ–°:</label>
            <select id="statusUpdate" name="statusUpdate">
              <option value="planned">è®¡åˆ’ä¸­</option>
              <option value="in_progress">æ‰§è¡Œä¸­</option>
              <option value="on_hold">æš‚åœ</option>
              <option value="completed">å·²å®Œæˆ</option>
              <option value="cancelled">å·²å–æ¶ˆ</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="progressNotes">è¿›åº¦è¯´æ˜:</label>
            <textarea id="progressNotes" name="progressNotes" rows="4" 
                      placeholder="æè¿°å½“å‰è¿›å±•ã€é‡åˆ°çš„é—®é¢˜æˆ–ä¸‹ä¸€æ­¥è®¡åˆ’..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="milestonesUpdate">é‡Œç¨‹ç¢‘æ›´æ–°:</label>
            <div id="milestonesProgress">
              <!-- åŠ¨æ€åŠ è½½é‡Œç¨‹ç¢‘è¿›åº¦ -->
            </div>
          </div>
          
          <div class="form-group">
            <label for="budgetSpent">å·²ç”¨é¢„ç®—:</label>
            <div class="budget-input">
              <input type="number" id="budgetSpent" name="budgetSpent" 
                     placeholder="0" min="0" step="100">
              <span id="budgetCurrency">USD</span>
            </div>
          </div>
          
          <div class="form-group">
            <label for="nextSteps">ä¸‹ä¸€æ­¥è®¡åˆ’:</label>
            <textarea id="nextSteps" name="nextSteps" rows="3" 
                      placeholder="æè¿°æ¥ä¸‹æ¥çš„å…·ä½“è¡ŒåŠ¨è®¡åˆ’..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="risksIssues">é£é™©å’Œé—®é¢˜:</label>
            <textarea id="risksIssues" name="risksIssues" rows="3" 
                      placeholder="æè¿°é‡åˆ°çš„é£é™©ã€é—®é¢˜æˆ–éœ€è¦æ”¯æŒçš„åœ°æ–¹..."></textarea>
          </div>
          
          <div class="form-group">
            <label for="attachments">ç›¸å…³é™„ä»¶:</label>
            <input type="file" id="attachments" name="attachments" multiple 
                   accept=".pdf,.doc,.docx,.xls,.xlsx,.ppt,.pptx,.jpg,.png">
            <div class="file-upload-hint">æ”¯æŒä¸Šä¼ æ–‡æ¡£ã€å›¾ç‰‡ç­‰ç›¸å…³æ–‡ä»¶</div>
          </div>
          
          <div class="form-actions">
            <button type="submit">æ›´æ–°è¿›åº¦</button>
            <button type="button" onclick="closeProgressModal()">å–æ¶ˆ</button>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
```

**è¡ŒåŠ¨è¿›åº¦ç®¡ç†JavaScriptï¼š**

```javascript
// è¡ŒåŠ¨è¿›åº¦ç®¡ç†ç±»
class ActionProgressManager {
  
  constructor() {
    this.currentActionId = null;
  }
  
  // æ˜¾ç¤ºè¿›åº¦æ›´æ–°ç•Œé¢
  showProgressUpdateModal(actionId) {
    this.currentActionId = actionId;
    
    // åŠ è½½è¡ŒåŠ¨è¯¦æƒ…å’Œå½“å‰è¿›åº¦
    google.script.run
      .withSuccessHandler(data => this.renderProgressModal(data))
      .withFailureHandler(error => this.handleError(error))
      .getActionProgressDetails(actionId);
    
    document.getElementById('actionProgressModal').style.display = 'block';
  }
  
  // æ¸²æŸ“è¿›åº¦æ¨¡æ€æ¡†
  renderProgressModal(data) {
    document.getElementById('actionId').textContent = data.actionId;
    document.getElementById('relatedInsight').textContent = data.relatedInsightId;
    document.getElementById('currentActionStatus').textContent = data.currentStatus;
    
    // æ›´æ–°è¿›åº¦æ¡
    this.updateProgressBar(data.currentProgress);
    
    // é¢„å¡«å……è¡¨å•
    document.getElementById('progressPercentage').value = data.currentProgress;
    document.getElementById('statusUpdate').value = data.currentStatus;
    document.getElementById('budgetSpent').value = data.budgetSpent || 0;
    document.getElementById('budgetCurrency').textContent = data.budgetCurrency;
    
    // æ¸²æŸ“é‡Œç¨‹ç¢‘è¿›åº¦
    this.renderMilestonesProgress(data.milestones);
  }
  
  // æ›´æ–°è¿›åº¦æ˜¾ç¤º
  updateProgressDisplay(value) {
    document.getElementById('progressValue').textContent = value + '%';
    this.updateProgressBar(value);
  }
  
  // æ›´æ–°è¿›åº¦æ¡
  updateProgressBar(percentage) {
    const progressFill = document.getElementById('progressFill');
    const progressText = document.getElementById('progressText');
    
    progressFill.style.width = percentage + '%';
    progressText.textContent = percentage + '%';
    
    // æ ¹æ®è¿›åº¦æ”¹å˜é¢œè‰²
    if (percentage < 30) {
      progressFill.className = 'progress-fill low';
    } else if (percentage < 70) {
      progressFill.className = 'progress-fill medium';
    } else {
      progressFill.className = 'progress-fill high';
    }
  }
  
  // æ¸²æŸ“é‡Œç¨‹ç¢‘è¿›åº¦
  renderMilestonesProgress(milestones) {
    const container = document.getElementById('milestonesProgress');
    container.innerHTML = '';
    
    milestones.forEach((milestone, index) => {
      const milestoneDiv = document.createElement('div');
      milestoneDiv.className = 'milestone-progress-item';
      milestoneDiv.innerHTML = `
        <div class="milestone-info">
          <span class="milestone-name">${milestone.name}</span>
          <span class="milestone-date">${milestone.date}</span>
        </div>
        <div class="milestone-status">
          <select name="milestoneStatus[]" data-milestone-index="${index}">
            <option value="pending" ${milestone.status === 'pending' ? 'selected' : ''}>å¾…å¼€å§‹</option>
            <option value="in_progress" ${milestone.status === 'in_progress' ? 'selected' : ''}>è¿›è¡Œä¸­</option>
            <option value="completed" ${milestone.status === 'completed' ? 'selected' : ''}>å·²å®Œæˆ</option>
            <option value="delayed" ${milestone.status === 'delayed' ? 'selected' : ''}>å»¶æœŸ</option>
          </select>
        </div>
      `;
      container.appendChild(milestoneDiv);
    });
  }
  
  // æäº¤è¿›åº¦æ›´æ–°
  submitProgressUpdate(formData) {
    const progressData = {
      actionId: this.currentActionId,
      progressPercentage: formData.progressPercentage,
      statusUpdate: formData.statusUpdate,
      progressNotes: formData.progressNotes,
      budgetSpent: formData.budgetSpent,
      nextSteps: formData.nextSteps,
      risksIssues: formData.risksIssues,
      milestonesStatus: this.getMilestonesStatus(),
      updatedBy: Session.getActiveUser().getEmail(),
      updatedAt: new Date().toISOString()
    };
    
    // å¤„ç†æ–‡ä»¶ä¸Šä¼ 
    const attachments = document.getElementById('attachments').files;
    if (attachments.length > 0) {
      this.uploadAttachments(attachments, progressData);
    } else {
      this.saveProgressUpdate(progressData);
    }
  }
  
  // è·å–é‡Œç¨‹ç¢‘çŠ¶æ€
  getMilestonesStatus() {
    const milestoneSelects = document.querySelectorAll('select[name="milestoneStatus[]"]');
    const milestonesStatus = [];
    
    milestoneSelects.forEach(select => {
      milestonesStatus.push({
        index: select.dataset.milestoneIndex,
        status: select.value
      });
    });
    
    return milestonesStatus;
  }
  
  // ä¿å­˜è¿›åº¦æ›´æ–°
  saveProgressUpdate(progressData) {
    google.script.run
      .withSuccessHandler(result => this.handleUpdateSuccess(result))
      .withFailureHandler(error => this.handleUpdateError(error))
      .updateActionProgress(progressData);
  }
  
  // å¤„ç†æ›´æ–°æˆåŠŸ
  handleUpdateSuccess(result) {
    this.showMessage('è¿›åº¦æ›´æ–°æˆåŠŸï¼', 'success');
    
    // åˆ·æ–°ç›¸å…³æ•°æ®æ˜¾ç¤º
    this.refreshActionData();
    
    // å…³é—­æ¨¡æ€æ¡†
    setTimeout(() => {
      this.closeModal();
    }, 2000);
  }
  
  // å¤„ç†æ›´æ–°é”™è¯¯
  handleUpdateError(error) {
    this.showMessage(`æ›´æ–°å¤±è´¥: ${error.message}`, 'error');
  }
}

// åˆå§‹åŒ–è¿›åº¦ç®¡ç†å™¨
const actionProgressManager = new ActionProgressManager();

// è¿›åº¦æ›´æ–°è¡¨å•æäº¤å¤„ç†
document.getElementById('progressUpdateForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const data = Object.fromEntries(formData.entries());
  actionProgressManager.submitProgressUpdate(data);
});
```

**åç«¯è¿›åº¦æ›´æ–°æœåŠ¡ï¼š**

```javascript
// æ›´æ–°è¡ŒåŠ¨è¿›åº¦
function updateActionProgress(progressData) {
  try {
    // è·å–è¡ŒåŠ¨å»ºè®®è¡¨
    const actionSheet = SpreadsheetApp.openById(ACTION_RECOMMENDATIONS_SHEET_ID)
                                    .getSheetByName('Action_Recommendations');
    
    const data = actionSheet.getDataRange().getValues();
    const headers = data[0];
    
    // æŸ¥æ‰¾å¯¹åº”çš„è¡ŒåŠ¨è®°å½•
    const actionIdCol = headers.indexOf('action_id');
    let targetRow = -1;
    
    for (let i = 1; i < data.length; i++) {
      if (data[i][actionIdCol] === progressData.actionId) {
        targetRow = i + 1;
        break;
      }
    }
    
    if (targetRow === -1) {
      throw new Error('æœªæ‰¾åˆ°å¯¹åº”çš„è¡ŒåŠ¨è®°å½•');
    }
    
    // æ›´æ–°è¿›åº¦ç›¸å…³å­—æ®µ
    const progressCol = headers.indexOf('progress_percentage');
    const statusCol = headers.indexOf('status');
    const notesCol = headers.indexOf('progress_notes');
    const budgetSpentCol = headers.indexOf('budget_spent');
    const updatedAtCol = headers.indexOf('updated_at');
    const updatedByCol = headers.indexOf('updated_by');
    
    actionSheet.getRange(targetRow, progressCol + 1).setValue(progressData.progressPercentage);
    actionSheet.getRange(targetRow, statusCol + 1).setValue(progressData.statusUpdate);
    actionSheet.getRange(targetRow, notesCol + 1).setValue(progressData.progressNotes);
    actionSheet.getRange(targetRow, budgetSpentCol + 1).setValue(progressData.budgetSpent);
    actionSheet.getRange(targetRow, updatedAtCol + 1).setValue(progressData.updatedAt);
    actionSheet.getRange(targetRow, updatedByCol + 1).setValue(progressData.updatedBy);
    
    // è®°å½•è¿›åº¦å†å²
    recordProgressHistory(progressData);
    
    // æ›´æ–°é‡Œç¨‹ç¢‘çŠ¶æ€
    if (progressData.milestonesStatus) {
      updateMilestonesStatus(progressData.actionId, progressData.milestonesStatus);
    }
    
    // å¦‚æœè¡ŒåŠ¨å®Œæˆï¼Œæ›´æ–°ç›¸å…³æ´å¯ŸçŠ¶æ€
    if (progressData.statusUpdate === 'completed') {
      updateRelatedInsightStatus(progressData.actionId, 'action_completed');
    }
    
    return {
      success: true,
      actionId: progressData.actionId,
      message: 'è¿›åº¦æ›´æ–°æˆåŠŸ'
    };
    
  } catch (error) {
    console.error('æ›´æ–°è¡ŒåŠ¨è¿›åº¦å¤±è´¥:', error);
    throw new Error(`æ›´æ–°å¤±è´¥: ${error.message}`);
  }
}

// è®°å½•è¿›åº¦å†å²
function recordProgressHistory(progressData) {
  try {
    // è·å–æˆ–åˆ›å»ºè¿›åº¦å†å²è¡¨
    const historySheet = getOrCreateProgressHistorySheet();
    
    const historyData = [
      generateProgressHistoryId(),
      progressData.actionId,
      progressData.progressPercentage,
      progressData.statusUpdate,
      progressData.progressNotes,
      progressData.nextSteps,
      progressData.risksIssues,
      progressData.updatedBy,
      progressData.updatedAt
    ];
    
    historySheet.appendRow(historyData);
    
  } catch (error) {
    console.error('è®°å½•è¿›åº¦å†å²å¤±è´¥:', error);
    // å†å²è®°å½•å¤±è´¥ä¸åº”è¯¥å½±å“ä¸»æµç¨‹
  }
}


// è·å–æˆ–åˆ›å»ºè¿›åº¦å†å²è¡¨
function getOrCreateProgressHistorySheet() {
  const spreadsheet = SpreadsheetApp.openById(ACTION_RECOMMENDATIONS_SHEET_ID);
  let historySheet = spreadsheet.getSheetByName('Progress_History');
  
  if (!historySheet) {
    historySheet = spreadsheet.insertSheet('Progress_History');
    const headers = [
      'history_id', 'action_id', 'progress_percentage', 'status',
      'progress_notes', 'next_steps', 'risks_issues', 'updated_by', 'updated_at'
    ];
    historySheet.getRange(1, 1, 1, headers.length).setValues([headers]);
  }
  
  return historySheet;
}

// ç”Ÿæˆè¿›åº¦å†å²ID
function generateProgressHistoryId() {
  const timestamp = new Date().toISOString().replace(/[-:T.]/g, '').substring(0, 14);
  const random = Math.random().toString(36).substring(2, 4).toUpperCase();
  return `PH${timestamp}${random}`;
}
```

è¿™ä¸ªå®Œå–„ç‰ˆæœ¬çš„è®¾è®¡æ–‡æ¡£ç°åœ¨åŒ…å«äº†ï¼š

1. **å…¨ç³»ç»Ÿæ•°å­—ç‚¹å‡»å±•å¼€åŠŸèƒ½** - æ‰€æœ‰é¡µé¢çš„æ•°å­—æŒ‡æ ‡éƒ½æ”¯æŒç‚¹å‡»å±•å¼€ï¼Œç»Ÿä¸€çš„äº¤äº’è§„èŒƒå’Œæ ·å¼
2. **é«˜ä»·å€¼çº¿ç´¢è¡ŒåŠ¨è¾“å…¥åŠŸèƒ½** - å®Œæ•´çš„è¡ŒåŠ¨è®¡åˆ’è¾“å…¥ç•Œé¢ï¼Œæ”¯æŒè¯¦ç»†çš„è¡ŒåŠ¨è§„åˆ’å’Œæ•°æ®åº“å†™å…¥
3. **è¡ŒåŠ¨è¿›åº¦è·Ÿè¸ªå’Œæ›´æ–°** - æ”¯æŒè¡ŒåŠ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¿›åº¦æ›´æ–°ã€çŠ¶æ€å˜æ›´å’Œå†å²è®°å½•
4. **æ•°æ®åº“é›†æˆ** - å®Œæ•´çš„åç«¯æœåŠ¡ï¼Œæ”¯æŒæ•°æ®çš„è¯»å–ã€å†™å…¥å’Œæ›´æ–°æ“ä½œ
5. **é€šçŸ¥å’Œæé†’æœºåˆ¶** - è¡ŒåŠ¨åˆ†é…é€šçŸ¥ã€è¿›åº¦æé†’ç­‰åŠŸèƒ½

æ•´ä¸ªç³»ç»Ÿè®¾è®¡ç¡®ä¿äº†ä»æŠ€æœ¯æ´å¯Ÿå‘ç°åˆ°è¡ŒåŠ¨æ‰§è¡Œçš„å®Œæ•´é—­ç¯ç®¡ç†ï¼Œä¸ºå†³ç­–è€…æä¾›äº†å¼ºå¤§çš„æŠ€æœ¯æƒ…æŠ¥åˆ†æå’Œè¡ŒåŠ¨ç®¡ç†èƒ½åŠ›ã€‚
