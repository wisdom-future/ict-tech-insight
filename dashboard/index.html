<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ æŠ€æœ¯æ´å¯Ÿç³»ç»Ÿ - ç›‘æ§ä»ªè¡¨æ¿</title>
    <link rel="stylesheet" href="assets/css/main.css">
    <link rel="stylesheet" href="assets/css/mobile.css">
    <meta name="theme-color" content="#2563eb">
    <meta name="description" content="æŠ€æœ¯æ´å¯Ÿç³»ç»Ÿå®æ—¶ç›‘æ§ä»ªè¡¨æ¿">
    
    <!-- ç®€åŒ–å›¾æ ‡å¼•ç”¨ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ğŸ¯</text></svg>">
</head>
<body>
    <!-- åŠ è½½é®ç½©å±‚ -->
    <div id="loadingOverlay" class="loading-overlay" style="display: flex;">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <h3>æŠ€æœ¯æ´å¯Ÿç³»ç»Ÿ</h3>
            <p id="loadingMessage">æ­£åœ¨åˆå§‹åŒ–ç³»ç»Ÿ...</p>
            <div class="loading-progress">
                <div class="progress-bar" id="progressBar"></div>
            </div>
        </div>
    </div>

    <!-- é”™è¯¯æ¨¡æ€æ¡† -->
    <div id="errorModal" class="error-modal hidden">
        <div class="error-content">
            <div class="error-header">
                <h3>ğŸš¨ ç³»ç»Ÿé”™è¯¯</h3>
                <button class="close-btn" id="closeError">&times;</button>
            </div>
            <div class="error-body">
                <p id="errorMessage">å‘ç”ŸæœªçŸ¥é”™è¯¯</p>
                <div id="errorDetails" class="error-details" style="display: none;">
                    <details>
                        <summary>æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯</summary>
                        <pre id="errorStack"></pre>
                    </details>
                </div>
            </div>
            <div class="error-footer">
                <button class="btn-retry" id="retryBtn">ğŸ”„ é‡è¯•</button>
                <button class="btn-report" id="reportBtn">ğŸ“§ æŠ¥å‘Šé—®é¢˜</button>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®é¢æ¿ -->
    <div id="settingsPanel" class="settings-panel hidden">
        <div class="settings-content">
            <div class="settings-header">
                <h3>âš™ï¸ ç³»ç»Ÿè®¾ç½®</h3>
                <button class="close-btn" id="closeSettings">&times;</button>
            </div>
            <div class="settings-body">
                <div class="setting-group">
                    <label for="refreshInterval">è‡ªåŠ¨åˆ·æ–°é—´éš” (ç§’)</label>
                    <select id="refreshInterval">
                        <option value="60000">1åˆ†é’Ÿ</option>
                        <option value="300000" selected>5åˆ†é’Ÿ</option>
                        <option value="600000">10åˆ†é’Ÿ</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label for="timeRangeSelect">æ—¶é—´èŒƒå›´</label>
                    <select id="timeRangeSelect">
                        <option value="24h" selected>24å°æ—¶</option>
                        <option value="7d">7å¤©</option>
                        <option value="30d">30å¤©</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label for="rankingCriteria">æ’è¡Œæ ‡å‡†</label>
                    <select id="rankingCriteria">
                        <option value="signal_strength" selected>ä¿¡å·å¼ºåº¦</option>
                        <option value="commercial_value">å•†ä¸šä»·å€¼</option>
                        <option value="breakthrough_score">æŠ€æœ¯çªç ´æ€§</option>
                    </select>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="chartAnimation" checked>
                        å¯ç”¨å›¾è¡¨åŠ¨ç”»
                    </label>
                </div>
                <div class="setting-group">
                    <label>
                        <input type="checkbox" id="darkMode">
                        æ·±è‰²æ¨¡å¼
                    </label>
                </div>
            </div>
            <div class="settings-footer">
                <button class="btn-save" id="saveSettings">ğŸ’¾ ä¿å­˜</button>
                <button class="btn-reset" id="resetSettings">ğŸ”„ é‡ç½®</button>
            </div>
        </div>
    </div>

    <!-- ä¸»ä»ªè¡¨æ¿å®¹å™¨ -->
    <div class="dashboard-container">
        <!-- å¤´éƒ¨åŒºåŸŸ -->
        <header class="dashboard-header">
            <div class="header-left">
                <h1>ğŸ¯ æŠ€æœ¯æ´å¯Ÿç³»ç»Ÿ</h1>
                <div class="system-status">
                    <span class="status-indicator" id="systemStatus">ğŸ”„ ç³»ç»ŸçŠ¶æ€ï¼šæ­£åœ¨åˆå§‹åŒ–...</span>
                </div>
                <div class="version-info">ç›‘æ§ä»ªè¡¨æ¿ v1.0.0 - ä¸šåŠ¡ç‰ˆ</div>
            </div>
            <div class="header-controls">
                <div class="last-update" id="lastUpdate">æœ€åæ›´æ–°: --</div>
                <button class="btn-refresh" id="refreshBtn">ğŸ”„ åˆ·æ–°</button>
                <button class="btn-settings" id="settingsBtn">âš™ï¸</button>
            </div>
        </header>

        <!-- ä¸»å†…å®¹åŒºåŸŸ -->
        <main class="dashboard-main">
            <!-- æ ¸å¿ƒæŒ‡æ ‡å¡ç‰‡ç½‘æ ¼ -->
            <section class="metrics-section">
                <div class="metrics-grid">
                    <!-- ç³»ç»Ÿå¥åº·åº¦å¡ç‰‡ -->
                    <div class="metric-card health-card">
                        <div class="metric-header">
                            <h3>ğŸ“Š ç³»ç»Ÿå¥åº·åº¦</h3>
                            <div class="metric-icon" id="healthIcon">ğŸ’š</div>
                        </div>
                        <div class="metric-value" id="systemHealth">--</div>
                        <div class="metric-trend neutral" id="healthTrend">ç³»ç»Ÿåˆå§‹åŒ–ä¸­</div>
                        <div class="metric-detail" id="healthDetail">æ­£åœ¨æ£€æµ‹ç³»ç»ŸçŠ¶æ€</div>
                        <div class="health-progress">
                            <div class="progress-bar" id="healthProgressBar" style="width: 0%"></div>
                        </div>
                    </div>

                    <!-- ä»Šæ—¥æ´å¯Ÿå¡ç‰‡ -->
                    <div class="metric-card insights-card">
                        <div class="metric-header">
                            <h3>ğŸ“ˆ ä»Šæ—¥æ´å¯Ÿ</h3>
                            <div class="metric-icon">ğŸ“Š</div>
                        </div>
                        <div class="metric-value" id="todayInsights">--</div>
                        <div class="metric-trend positive" id="insightsTrend">ğŸ‘† ä¸æ˜¨æ—¥å¯¹æ¯”</div>
                        <div class="metric-detail" id="insightsDetail">åŒ…å«é«˜ä»·å€¼æ´å¯Ÿ -- æ¡</div>
                    </div>

                    <!-- å‘Šè­¦æ•°é‡å¡ç‰‡ -->
                    <div class="metric-card alert-card">
                        <div class="metric-header">
                            <h3>âš ï¸ å‘Šè­¦æ•°é‡</h3>
                            <div class="metric-icon">ğŸš¨</div>
                        </div>
                        <div class="metric-value" id="alertCount">--</div>
                        <div class="metric-trend neutral" id="alertTrend">ğŸ‘† éœ€è¦å…³æ³¨</div>
                        <div class="metric-detail" id="alertDetail">-- ä¸ªé«˜ä¼˜å…ˆçº§å‘Šè­¦</div>
                    </div>

                    <!-- è¿è¡ŒçŠ¶æ€å¡ç‰‡ -->
                    <div class="metric-card workflow-card">
                        <div class="metric-header">
                            <h3>ğŸ”„ è¿è¡ŒçŠ¶æ€</h3>
                            <div class="metric-icon">âš¡</div>
                        </div>
                        <div class="metric-value" id="runningWorkflows">è¿è¡Œä¸­</div>
                        <div class="metric-trend positive" id="workflowTrend">-- ä¸ªå·¥ä½œæµ</div>
                        <div class="metric-detail" id="workflowDetail">ç³»ç»Ÿæ­£å¸¸è¿è¡Œ</div>
                    </div>
                </div>
            </section>

            <!-- æ•°æ®æµè½¬åˆ†æ -->
            <section class="data-flow-section">
                <div class="section-header">
                    <h2>ğŸ“Š æ ¸å¿ƒä¸šåŠ¡å¯è§†åŒ–</h2>
                </div>
                <div class="section-subtitle">æ•°æ®æ”¶æ•›æµè½¬åˆ†æ</div>
                <div class="flow-description">ğŸ“Š å±•ç¤ºä»åŸå§‹æ•°æ®åˆ°æœ€ç»ˆæŠ€æœ¯çº¿ç´¢çš„æ”¶æ•›è¿‡ç¨‹å’Œæ•°é‡åˆ†å¸ƒ</div>
                
                <!-- æ•°æ®æµè½¬ç»Ÿè®¡ -->
                <div class="data-flow-stats">
                    <div class="stats-grid">
                        <div class="stat-item">
                            <div class="stat-label">è½¬åŒ–ç‡</div>
                            <div class="stat-value" id="conversionRate">--</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">å¤„ç†æ•ˆç‡</div>
                            <div class="stat-value" id="processingEfficiency">--</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">æ€»è¾“å…¥</div>
                            <div class="stat-value" id="totalInput">--</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-label">æ€»è¾“å‡º</div>
                            <div class="stat-value" id="totalOutput">--</div>
                        </div>
                    </div>
                </div>
                
                <!-- æµè½¬æ­¥éª¤å±•ç¤º -->
                <div class="flow-steps-container">
                    <div class="flow-step" id="rawDataStep">
                        <div class="step-icon">ğŸ“¥</div>
                        <div class="step-content">
                            <h4>åŸå§‹æ•°æ® (RAW)</h4>
                            <div class="step-value" id="rawDataCount">--</div>
                            <div class="step-detail">æ¥æº: å­¦æœ¯è®ºæ–‡ã€ä¸“åˆ©ã€æ–°é—»ç­‰</div>
                        </div>
                        <div class="step-progress">
                            <div class="progress-bar" style="width: 100%"></div>
                        </div>
                    </div>

                    <div class="flow-arrow">â¬‡ï¸</div>
                    <div class="flow-conversion" id="rawToIntel">87% è½¬åŒ–ç‡</div>

                    <div class="flow-step" id="intelligenceStep">
                        <div class="step-icon">ğŸ§ </div>
                        <div class="step-content">
                            <h4>æ™ºèƒ½æ´å¯Ÿ (Intelligence)</h4>
                            <div class="step-value" id="intelligenceCount">--</div>
                            <div class="step-detail">AIè¯†åˆ«çš„æŠ€æœ¯ä¿¡å·</div>
                        </div>
                        <div class="step-progress">
                            <div class="progress-bar" style="width: 87%"></div>
                        </div>
                    </div>

                    <div class="flow-arrow">â¬‡ï¸</div>
                    <div class="flow-conversion" id="intelToClues">78% è½¬åŒ–ç‡</div>

                    <div class="flow-step" id="cluesStep">
                        <div class="step-icon">ğŸ”</div>
                        <div class="step-content">
                            <h4>æŠ€æœ¯çº¿ç´¢ (Clues)</h4>
                            <div class="step-value" id="cluesCount">--</div>
                            <div class="step-detail">éªŒè¯é€šè¿‡çš„æœ‰æ•ˆçº¿ç´¢</div>
                        </div>
                        <div class="step-progress">
                            <div class="progress-bar" style="width: 78%"></div>
                        </div>
                    </div>

                    <div class="flow-arrow">â¬‡ï¸</div>
                    <div class="flow-conversion" id="cluesToActions">65% è½¬åŒ–ç‡</div>

                    <div class="flow-step" id="actionsStep">
                        <div class="step-icon">ğŸ¯</div>
                        <div class="step-content">
                            <h4>è¡ŒåŠ¨å»ºè®® (Actions)</h4>
                            <div class="step-value" id="actionsCount">--</div>
                            <div class="step-detail">å¯æ‰§è¡Œçš„å†³ç­–å»ºè®®</div>
                        </div>
                        <div class="step-progress">
                            <div class="progress-bar" style="width: 65%"></div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- å·¥ä½œæµçŠ¶æ€ç›‘æ§ -->
            <section class="workflow-section">
                <div class="section-header">
                    <h2>å·¥ä½œæµå®æ—¶çŠ¶æ€ç›‘æ§</h2>
                </div>
                <div class="section-subtitle">ğŸ”„ æ˜¾ç¤ºå½“å‰æ‰€æœ‰å·¥ä½œæµçš„æœ€æ–°æ‰§è¡ŒçŠ¶æ€å’Œæ—¶é—´ä¿¡æ¯</div>

                <div class="workflow-status-panel">
                    <div class="panel-header">
                        <h3>å½“å‰å·¥ä½œæµçŠ¶æ€</h3>
                        <div class="status-legend">
                            <div class="legend-item">
                                <div class="dot success"></div>
                                <span>å·²å®Œæˆ</span>
                            </div>
                            <div class="legend-item">
                                <div class="dot warning"></div>
                                <span>è¿è¡Œä¸­</span>
                            </div>
                            <div class="legend-item">
                                <div class="dot danger"></div>
                                <span>å¤±è´¥</span>
                            </div>
                            <div class="legend-item">
                                <div class="dot secondary"></div>
                                <span>ç­‰å¾…ä¸­</span>
                            </div>
                        </div>
                    </div>
                    <div class="workflow-list" id="workflowList">
                        <div class="loading">æ­£åœ¨åŠ è½½å·¥ä½œæµçŠ¶æ€...</div>
                    </div>
                </div>
            </section>

            <!-- ä¸šåŠ¡ä»·å€¼åˆ†æ -->
            <section class="value-section">
                <div class="section-header">
                    <h2>ğŸ’° ä¸šåŠ¡ä»·å€¼åˆ†æ</h2>
                </div>

                <div class="value-stats">
                    <div class="value-stat-item">
                        <div class="stat-icon">ğŸ¯</div>
                        <div class="stat-content">
                            <div class="stat-label">é«˜ä»·å€¼æ´å¯Ÿ</div>
                            <div class="stat-value" id="highValueCount">--</div>
                        </div>
                    </div>
                    <div class="value-stat-item">
                        <div class="stat-icon">ğŸ’</div>
                        <div class="stat-content">
                            <div class="stat-label">æŠ•èµ„æœºä¼š</div>
                            <div class="stat-value" id="investmentOpportunities">--</div>
                        </div>
                    </div>
                </div>

                <div class="top-intelligence-panel">
                    <div class="panel-header">
                        <h3>TOP æ´å¯Ÿæ’è¡Œ</h3>
                        <div class="chart-controls">
                            <select id="rankingSelect">
                                <option value="signal_strength">ä¿¡å·å¼ºåº¦</option>
                                <option value="commercial_value">å•†ä¸šä»·å€¼</option>
                                <option value="breakthrough_score">æŠ€æœ¯çªç ´æ€§</option>
                            </select>
                        </div>
                    </div>
                    <div class="intelligence-list" id="intelligenceList">
                        <div class="loading">æ­£åœ¨åŠ è½½æ´å¯Ÿæ•°æ®...</div>
                    </div>
                </div>
            </section>

            <!-- æŠ€æœ¯è¶‹åŠ¿åˆ†æ -->
            <section class="trends-section">
                <div class="section-header">
                    <h2>ğŸ”¥ æŠ€æœ¯è¶‹åŠ¿åˆ†æ</h2>
                </div>

                <div class="trends-stats-panel">
                    <div class="panel-header">
                        <h3>è¶‹åŠ¿ç»Ÿè®¡</h3>
                    </div>
                    <div class="trends-list" id="trendsList">
                        <div class="loading">æ­£åœ¨åˆ†æè¶‹åŠ¿...</div>
                    </div>
                </div>
            </section>

            <!-- è¯¦ç»†ä¿¡æ¯é¢æ¿ -->
            <section class="details-section">
                <div class="details-grid">
                    <div class="insights-detail">
                        <div class="panel-header">
                            <h3>ğŸ“ˆ ä»Šæ—¥æ´å¯Ÿè¯¦æƒ…</h3>
                        </div>
                        <div class="detail-content" id="insightsDetailContent">
                            <div class="loading">æ­£åœ¨åŠ è½½æ´å¯Ÿè¯¦æƒ…...</div>
                        </div>
                    </div>

                    <div class="alerts-detail">
                        <div class="panel-header">
                            <h3>âš ï¸ ç³»ç»Ÿå‘Šè­¦è¯¦æƒ…</h3>
                        </div>
                        <div class="detail-content" id="alertsDetailContent">
                            <div class="loading">æ­£åœ¨æ£€æŸ¥ç³»ç»Ÿå‘Šè­¦...</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- ç³»ç»Ÿæ§åˆ¶é¢æ¿ -->
            <section class="control-section">
                <div class="panel-header">
                    <h3>ğŸ›ï¸ ç³»ç»Ÿæ§åˆ¶</h3>
                </div>
                <div class="control-buttons">
                    <button class="control-btn primary" id="processBtn">
                        ğŸ”„ å¤„ç†è¯·æ±‚
                    </button>
                    <button class="control-btn secondary" id="resetBtn">
                        ğŸ”„ é‡ç½®ç³»ç»Ÿ
                    </button>
                    <button class="control-btn info" id="exportBtn">
                        ğŸ“¤ å¯¼å‡ºæ•°æ®
                    </button>
                </div>
                <div class="control-status" id="controlStatus">
                    <div class="status-message">
                        <span class="status-icon">âœ…</span>
                        <span class="status-text">ç³»ç»Ÿè¿è¡Œæ­£å¸¸ - æ‰€æœ‰æœåŠ¡å·²å¯åŠ¨</span>
                    </div>
                </div>
            </section>
        </main>

        <!-- é¡µè„š -->
        <footer class="dashboard-footer">
            <div class="footer-content">
                <div class="footer-left">
                    <p>Â© 2024 æŠ€æœ¯æ´å¯Ÿå†³ç­–å¼•æ“ | å®æ—¶ç›‘æ§ä»ªè¡¨æ¿ | æ•°æ®æº: Google Sheets | v1.0.0 - ä¸šåŠ¡ç‰ˆ</p>
                </div>
                <div class="footer-right">
                    <span>éƒ¨ç½²æ—¶é—´: <span id="deployTime">2024-06-22 08:00:00</span></span>
                    <span class="separator">|</span>
                    <span>æœ€åæ›´æ–°: <span id="footerUpdate">--</span></span>
                    <span class="separator">|</span>
                    <span>APIçŠ¶æ€: <span class="api-status" id="apiStatus">æ£€æµ‹ä¸­</span></span>
                    <span class="separator">|</span>
                    <span>æ•°æ®æ¡æ•°: <span id="dataCount">0</span></span>
                </div>
            </div>
        </footer>
    </div>

    <!-- Toast é€šçŸ¥å®¹å™¨ -->
    <div id="toastContainer" class="toast-container"></div>

    <!-- ä¿®å¤åçš„è„šæœ¬åŠ è½½ - ä¸åŒ…å«charts.js -->
    <script>
        // å…¨å±€å˜é‡å£°æ˜
        window.CONFIG = null;
        window.Utils = null;
        window.api = null;
        window.app = null;
        
        // ç®€åŒ–çš„å›¾è¡¨å¯¹è±¡ï¼Œé¿å…é”™è¯¯
        window.dashboardCharts = {
            initCharts: function() {
                console.log('å›¾è¡¨åŠŸèƒ½å·²ç¦ç”¨ï¼Œä½¿ç”¨ç®€åŒ–æ˜¾ç¤º');
                return Promise.resolve();
            },
            updateTimelineChart: function(data) {
                console.log('æ—¶é—´çº¿å›¾è¡¨æ›´æ–°ï¼ˆç®€åŒ–æ¨¡å¼ï¼‰');
            },
            updateFunnelChart: function(data) {
                console.log('æ¼æ–—å›¾è¡¨æ›´æ–°ï¼ˆç®€åŒ–æ¨¡å¼ï¼‰');
            },
            updateScatterChart: function(data) {
                console.log('æ•£ç‚¹å›¾è¡¨æ›´æ–°ï¼ˆç®€åŒ–æ¨¡å¼ï¼‰');
            },
            getChartsStatus: function() {
                return { simplified: true };
            },
            destroyAllCharts: function() {
                console.log('å›¾è¡¨æ¸…ç†å®Œæˆ');
            }
        };
        
        // é”™è¯¯å¤„ç†
        window.addEventListener('error', function(e) {
            console.error('å…¨å±€é”™è¯¯:', e.error);
        });
        
        window.addEventListener('unhandledrejection', function(e) {
            console.error('Promiseé”™è¯¯:', e.reason);
        });
    </script>

    <!-- æŒ‰é¡ºåºåŠ è½½è„šæœ¬ï¼Œè·³è¿‡charts.js -->
    <script>
        // 1. é¦–å…ˆåŠ è½½é…ç½®
        const script1 = document.createElement('script');
        script1.src = 'config/config.js';
        script1.onload = function() {
            console.log('âœ… CONFIGå·²åŠ è½½');
            loadUtils();
        };
        script1.onerror = function() {
            console.error('âŒ CONFIGåŠ è½½å¤±è´¥');
            showError('é…ç½®æ–‡ä»¶åŠ è½½å¤±è´¥');
        };
        document.head.appendChild(script1);
        
        function loadUtils() {
            // 2. åŠ è½½å·¥å…·å‡½æ•°
            const script2 = document.createElement('script');
            script2.src = 'assets/js/utils.js';
            script2.onload = function() {
                console.log('âœ… Utilså·²åŠ è½½');
                loadAPI();
            };
            script2.onerror = function() {
                console.error('âŒ UtilsåŠ è½½å¤±è´¥');
                showError('å·¥å…·å‡½æ•°åŠ è½½å¤±è´¥');
            };
            document.head.appendChild(script2);
        }
        
        function loadAPI() {
            // 3. åŠ è½½APIæ¨¡å—
            const script3 = document.createElement('script');
            script3.src = 'assets/js/api.js';
            script3.onload = function() {
                console.log('âœ… APIå·²åŠ è½½');
                // è·³è¿‡charts.jsï¼Œç›´æ¥åŠ è½½app.js
                loadApp();
            };
            script3.onerror = function() {
                console.error('âŒ APIåŠ è½½å¤±è´¥');
                showError('APIæ¨¡å—åŠ è½½å¤±è´¥');
            };
            document.head.appendChild(script3);
        }
        
        function loadApp() {
            // 4. åŠ è½½ä¸»åº”ç”¨ï¼ˆè·³è¿‡charts.jsï¼‰
            const script4 = document.createElement('script');
            script4.src = 'assets/js/app.js';
            script4.onload = function() {
                console.log('âœ… Appå·²åŠ è½½');
                initializeApp();
            };
            script4.onerror = function() {
                console.error('âŒ AppåŠ è½½å¤±è´¥');
                showError('ä¸»åº”ç”¨åŠ è½½å¤±è´¥');
            };
            document.head.appendChild(script4);
        }
        
        function initializeApp() {
            console.log('=== å¼€å§‹åˆå§‹åŒ–åº”ç”¨ï¼ˆç®€åŒ–æ¨¡å¼ï¼‰===');
            
            // æ£€æŸ¥æ ¸å¿ƒä¾èµ–
            const dependencies = {
                CONFIG: typeof CONFIG !== 'undefined',
                Utils: typeof Utils !== 'undefined',
                api: typeof api !== 'undefined',
                app: typeof app !== 'undefined'
            };
            
            console.log('ä¾èµ–æ£€æŸ¥:', dependencies);
            
            if (dependencies.CONFIG && dependencies.Utils && dependencies.api && dependencies.app) {
                console.log('âœ… æ‰€æœ‰æ ¸å¿ƒä¾èµ–å·²åŠ è½½');
                
                // åˆå§‹åŒ–åº”ç”¨
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', startApp);
                } else {
                    startApp();
                }
            } else {
                console.error('âŒ æ ¸å¿ƒä¾èµ–ç¼ºå¤±');
                showError('ç³»ç»Ÿä¾èµ–åŠ è½½ä¸å®Œæ•´');
            }
        }
        
        function startApp() {
            try {
                console.log('å¯åŠ¨åº”ç”¨ï¼ˆç®€åŒ–æ¨¡å¼ï¼‰...');
                
                if (typeof app !== 'undefined' && app.init) {
                    // ä¿®æ”¹CONFIGä¸­çš„åˆ·æ–°é—´éš”
                    if (typeof CONFIG !== 'undefined') {
                        CONFIG.REFRESH.AUTO_REFRESH_INTERVAL = 300000; // 5åˆ†é’Ÿ
                        CONFIG.REFRESH.RETRY_DELAY = 5000; // 5ç§’é‡è¯•å»¶è¿Ÿ
                    }
                    
                    app.init().then(() => {
                        console.log('âœ… åº”ç”¨å¯åŠ¨æˆåŠŸï¼ˆç®€åŒ–æ¨¡å¼ï¼‰');
                        hideLoading();
                    }).catch(error => {
                        console.error('âŒ åº”ç”¨å¯åŠ¨å¤±è´¥:', error);
                        showError('åº”ç”¨åˆå§‹åŒ–å¤±è´¥: ' + error.message);
                        hideLoading();
                    });
                } else {
                    throw new Error('appå¯¹è±¡æˆ–initæ–¹æ³•ä¸å­˜åœ¨');
                }
            } catch (error) {
                console.error('å¯åŠ¨è¿‡ç¨‹å‡ºé”™:', error);
                showError('åº”ç”¨å¯åŠ¨é”™è¯¯: ' + error.message);
                hideLoading();
            }
        }
        
        function showError(message) {
            hideLoading();
            
            const errorModal = document.getElementById('errorModal');
            const errorMessage = document.getElementById('errorMessage');
            
            if (errorModal && errorMessage) {
                errorMessage.textContent = message;
                errorModal.classList.remove('hidden');
            } else {
                alert(message);
            }
        }
        
        function hideLoading() {
            const loadingOverlay = document.getElementById('loadingOverlay');
            if (loadingOverlay) {
                loadingOverlay.style.display = 'none';
            }
        }
        
        // é”™è¯¯æ¨¡æ€æ¡†å…³é—­äº‹ä»¶
        document.addEventListener('DOMContentLoaded', function() {
            const closeError = document.getElementById('closeError');
            const retryBtn = document.getElementById('retryBtn');
            
            if (closeError) {
                closeError.addEventListener('click', function() {
                    document.getElementById('errorModal').classList.add('hidden');
                });
            }
            
            if (retryBtn) {
                retryBtn.addEventListener('click', function() {
                    document.getElementById('errorModal').classList.add('hidden');
                    location.reload();
                });
            }
        });
    </script>

    <!-- æ·»åŠ ç®€åŒ–æ ·å¼ -->
    <style>
        .data-flow-stats {
            margin: 2rem 0;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .stat-item {
            background: var(--bg-secondary);
            padding: 1rem;
            border-radius: var(--radius-md);
            text-align: center;
        }
        
        .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .value-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }
        
        .value-stat-item {
            background: var(--bg-card);
            padding: 1.5rem;
            border-radius: var(--radius-lg);
            display: flex;
            align-items: center;
            gap: 1rem;
            box-shadow: var(--shadow);
        }
        
        .stat-icon {
            font-size: 2rem;
            opacity: 0.8;
        }
        
        .stat-content .stat-label {
            font-size: 0.875rem;
            color: var(--text-secondary);
        }
        
        .stat-content .stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--text-primary);
        }
        
        .health-progress {
            width: 100%;
            height: 4px;
            background: var(--bg-tertiary);
            border-radius: var(--radius-sm);
            overflow: hidden;
            margin-top: 1rem;
        }
    </style>
</body>
</html>
